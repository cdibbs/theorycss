<html>
	<head>
		<title>Theory Tests</title>
		<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
		<script type='text/javascript' src='theory.js'></script>
		<script type='text/javascript' src='compiler.js'></script>
		<script type='text/javascript'>
			$(document).ready(function() {
				theory.yy = theoryCompiler;
				var result = theory.parse($('#kludge').text());
				console.log(result);
			});
		</script>
		tree frags => [[div]] [[span]] |_ x3
		frag functions => ((node)) ((child)) ((...))
		function expressions => fn name(bob) -> expression
		data definitions
		theories
		
		<script type='text/x-theory' id='kludge'>
			/*
			data Number a = long a | int a | float a | double a;
			data RGBa c = (int r, int g, int b, float a);
			data HSLa c = (float h, float s, float l, float a);
			data Color c = RGBa c | HSLa c;
			data Tree a =  Leaf a | Branch [Tree a];
			data ImgCtx ctx = (string source, string alt, image img);
			data Image img = { [Attr], [ImgCtx] };  
			*/
			
			/*Image OurOffice {
				src = '/img/stock-photo.jpg',
				alt = 'Our office',
				
				ImgCtx Bannerized = fn(Color tint = Tertiary.Veridian)
					-> filter(tint, trim(scale(self, ...))),
				
				ImgCtx Taggable = fn()
					-> doStuffToEnhanceIt()
			}*/
			
			
			/* my very first theory */
			theory Color {
				
				ns RYB {
					ns Primary {
						Red = Color(255, 0, 0, 1);
						Yellow = RGBa(255, 255, 0, 1);
						Blue = RGBa(0, 0, 255, 1);
					};
					
					ns Secondary {
						... Primary ...
						Orange = (Red + Yellow) / 2;
						Purple = (Red + Blue) / 2;
						Green = (Yellow + Blue) / 2;
					};
					
					ns Tertiary {
						... Secondary ...
						Vermilion = (Red + Orange) / 2;
						Amber = (Yellow + Orange) / 2;
						Chartreuse = (Yellow + Green) / 2;
						Viridian = (Blue + Green) / 2;
						Violet = (Blue + Purple) / 2;
						Magenta = (Red + Purple) / 2;
					};
				};
								
				fn Tuple rgba(int r, int g, int b, int a = 1) -> new Tuple(r, g, b, a);
				
				fn Tuple ryba(int r, int y, int b, int a = 1) -> new Tuple(r, (y+b)/2, b, a);
				
				fn Tuple hsla(int h, int s, int l, int a = 1) -> new Tuple();
				
				/**
	 			* Darkens a color by a decimal. p = 0.05 means darken L by 5%, in HSL.
	 			*/ 
				fn Color Darken(Color c, Number p) -> c * (1 - p);

				/**
	 			* Lightens a color by a decimal. p = 0.05 means lighten L by 5%, in HSL.
	 			*/
				fn Color Lighten(Color c, Number p) -> c * (1 + p);

				/**
				 * Sets the lightness of a Color (range 0.0 to 1.0) in HSL
				 */
				fn Color SetLightness(Color c, Number p) -> (c.toHSLa() and (-1,-1,0,-1)) or (0,0,-p,0);
			
				/**
				 * 
				 */
				fn Color Complement(Color c) -> Rotate(c, 180);
			
				fn Color Rotate(Color c, Number degrees) -> 0;
			
				/**
				 * Given a color, find the two colors adjacent to its complement at the given
				 * division level of the color wheel (1 = primary colors, 2 = secondary, etc),
				 * where the level indicates 3*2^(level-1) divisions of the wheel. The complement 
				 * pair on the tertiary wheel (level = 3) would each be +/- 15 degrees from
				 * the complement.  
				 */
				fn Color[] ComplementPair(Color c, Number level)
					-> [ Rotate(c, 180-360/3*2^(level-1)),
						 Rotate(c, 180+360/3*2^(level-1)) ];
						 
			}
			
			theory Main {
				[-- Colors :: Color --]
				dominant = rgba(255,255,0,1);
				(decor1, decor2) = ComplementPair(dominant, 3);
				scrunched @=
					desktop -> decor1
					tablet -> decor2
					mobile -> rgba(255,0,0,1);
				OffWhite = #fafafa;
					
				[-- Assertions --]
				IsTrue(Contrast(Colors.scrunched, Colors.dominant) > 0.5);
				AreEqual()

				[-- Media --]
				desktop = "screen and (width >= 1200px)";
				tablet = "screen and (width >= 800px)";
				mobile = "screen and (width >= 400px)";
				
				treeFrag login = 
					(form
						(input.text, input.password, input.submit)
					)
					
				ff fixedbar(align, thickness) = 
					((block)) 
						-> style ({ display:fixed, top:0, left:0, right:0, bottom:0 } - { \align:0 })
						<- style if t!? then { \axis : t } else nothing endif
							where axis = if align in ('top', 'bottom') then 'height' else 'width' endif
							yield { thickness : t }
						
						((...)) // e.g., bootstrap-y .container, .row, .row-fluid, etc  
							((a)) 
								((img))
									<- yield
										t = if (thickness!) then thickness
										else 
											(if align in ('top', 'bottom') then img.height else img.width endif) 
											?? thickness
										endif 
							
							((#login))
						
					
				ff curveddeck() = 
					(any
						-> yield x = 0, y = 0
						
						(...
							-> apply { position:relative, top:y, left:x, height:100% }
								where x = x * 2, y = y * 2
								
						)
					)
				
				[[html]]
					[[body]]
						[[div.navbar]] : fixedbar('top', 32px)
							<- @desktop: fixedbar('top', 32px)
							<- @mobile: {display:none}
							<- @tablet: fixedbar('top', 32px)
							@desktop {
								display: fixed;
								z-index: 1030;
							}
						[[div.main]]
							<- @desktop: menu(left, 25%)
							<- @tablet: menu(top, 48px)
							[[div.content]]
								<- @desktop: twocol
								<- @tablet: onecol
								// three decks, 7 cards each
								[[div.deck]] x 3 : curveddeck()
									[[div]] 
										|_ x 7
									
						[[div.footer]] <- footer
							
					{ display: fixed; left: 0; right: 0; top: 0; height: 32px; margin: 0; z-index: 1030; }
				/* { fixed; edges l,r,t=0; height: 32px; margin: 0; z 1030; } */
									
					[[div]] {
						{ width: 100%; height: 100%; background: $OffWhite; background-image: linear-gradient(to top, #fff, #f2f2f2);
							padding-left: 0; padding-right: 0; box-shadow: 0 1px 10px rgba(0,0,0,0.1); }
						/* { fill; bg OffWhite 'repeat-x'; grad 'to left top', White, #f2f2f2; padding sides=0; shadow 0 1px 10px black\a=0.1; } */
						
					}
				}
				
				
				fn Color Chris(Color variable) -> 0;
			}
			
			/*test Main {
				[-- Colors :: Color --]
				IsTrue(Contrast(scrunched, dominant) > Contrasts.RGColorBlind_EasilyReadable);
			}*/
			
			theory Another extends Bob {
				
			}
		</script>
	</head>
	<body>
	<div class='navbar-fixed-top'>
		<div class='navbar-inner'>
			<div class='container'>
				<div class='row'>
					<div class='span6'>
						<span class='hordz-logo'>Hordz.Org</span>
					</div>	
					<div class='span6'>
						<form method='post' class="navbar-form login-form" action='/accounts/logout'>
							<input type='hidden' name='csrfmiddlewaretoken' value='uMQTosgrQM5emlC1uWDmv6PjYnEG7iJZ' />
							<div>
								Welcome,
								<a href='/accounts/home' title='Go to your profile'>
									cdibbs</a>.
							</div>
							<button type="submit" class="logout-btn btn btn-primary">Logout</button>
							<a href='#' class='btn btn-info help-btn'>Help</a>
						</form>						
					</div>
				</div>
			</div>
		</div>
	</div>
		
	</body>
</html>